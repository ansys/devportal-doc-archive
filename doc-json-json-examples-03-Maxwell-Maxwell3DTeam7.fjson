{"parents": [{"link": "../../", "title": "Examples"}, {"link": "../", "title": "Maxwell examples"}], "prev": {"link": "../Maxwell3DTeam3/", "title": "Maxwell 3D: bath plate analysis"}, "next": {"link": "../Maxwell3D_Choke/", "title": "Maxwell 3D: choke setup"}, "title": "Maxwell 3D: asymmetric conductor analysis", "meta": null, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-03-maxwell-maxwell3dteam7-py\"><span class=\"std std-ref\">here</span></a>\nto download the full example code</p>\n</div>\n<section class=\"sphx-glr-example-title\" id=\"maxwell-3d-asymmetric-conductor-analysis\">\n<span id=\"sphx-glr-examples-03-maxwell-maxwell3dteam7-py\"></span><h1>Maxwell 3D: asymmetric conductor analysis<a class=\"headerlink\" href=\"#maxwell-3d-asymmetric-conductor-analysis\" title=\"Permalink to this heading\">#</a></h1>\n<p>This example uses PyAEDT to set up the TEAM 7 problem for an asymetric\nconductor with a hole and solve it using the Maxwell 3D Eddy Current solver.</p>\n<section id=\"perform-required-imports\">\n<h2>Perform required imports<a class=\"headerlink\" href=\"#perform-required-imports\" title=\"Permalink to this heading\">#</a></h2>\n<p>Perform required imports.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">pyaedt</span> <span class=\"kn\">import</span> <span class=\"n\">Maxwell3d</span>\n<span class=\"kn\">from</span> <span class=\"nn\">pyaedt</span> <span class=\"kn\">import</span> <span class=\"n\">generate_unique_project_name</span>\n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">csv</span>\n<span class=\"kn\">import</span> <span class=\"nn\">os</span>\n</pre></div>\n</div>\n</section>\n<section id=\"set-non-graphical-mode\">\n<h2>Set non-graphical mode<a class=\"headerlink\" href=\"#set-non-graphical-mode\" title=\"Permalink to this heading\">#</a></h2>\n<p>Set non-graphical mode. <code class=\"docutils literal notranslate\"><span class=\"pre\">&quot;PYAEDT_NON_GRAPHICAL&quot;</span></code> is needed to generate\ndocumentation only.\nYou can set <code class=\"docutils literal notranslate\"><span class=\"pre\">non_graphical</span></code> either to <code class=\"docutils literal notranslate\"><span class=\"pre\">True</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">False</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">non_graphical</span> <span class=\"o\">=</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">getenv</span><span class=\"p\">(</span><span class=\"s2\">&quot;PYAEDT_NON_GRAPHICAL&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;False&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">lower</span><span class=\"p\">()</span> <span class=\"ow\">in</span> <span class=\"p\">(</span><span class=\"s2\">&quot;true&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;1&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;t&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"launch-aedt-and-maxwell-3d\">\n<h2>Launch AEDT and Maxwell 3D<a class=\"headerlink\" href=\"#launch-aedt-and-maxwell-3d\" title=\"Permalink to this heading\">#</a></h2>\n<p>Launch AEDT and Maxwell 3D. The following code sets up the project and design names, the solver, and\nthe version. It also creates an instance of the <code class=\"docutils literal notranslate\"><span class=\"pre\">Maxwell3d</span></code> class named <code class=\"docutils literal notranslate\"><span class=\"pre\">M3D</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Project_Name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;COMPUMAG&quot;</span>\n<span class=\"n\">Design_Name</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;TEAM 7 Asymmetric Conductor&quot;</span>\n<span class=\"n\">Solver</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;EddyCurrent&quot;</span>\n<span class=\"n\">DesktopVersion</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;2022.2&quot;</span>\n\n<span class=\"n\">M3D</span> <span class=\"o\">=</span> <span class=\"n\">Maxwell3d</span><span class=\"p\">(</span>\n    <span class=\"n\">projectname</span><span class=\"o\">=</span><span class=\"n\">generate_unique_project_name</span><span class=\"p\">(),</span>\n    <span class=\"n\">designname</span><span class=\"o\">=</span><span class=\"n\">Design_Name</span><span class=\"p\">,</span>\n    <span class=\"n\">solution_type</span><span class=\"o\">=</span><span class=\"n\">Solver</span><span class=\"p\">,</span>\n    <span class=\"n\">specified_version</span><span class=\"o\">=</span><span class=\"n\">DesktopVersion</span><span class=\"p\">,</span>\n    <span class=\"n\">non_graphical</span><span class=\"o\">=</span><span class=\"n\">non_graphical</span>\n<span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">model_units</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;mm&quot;</span>\n<span class=\"n\">modeler</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span>\n<span class=\"n\">Plot</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">odesign</span><span class=\"o\">.</span><span class=\"n\">GetModule</span><span class=\"p\">(</span><span class=\"s2\">&quot;ReportSetup&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"add-maxwell-3d-setup\">\n<h2>Add Maxwell 3D setup<a class=\"headerlink\" href=\"#add-maxwell-3d-setup\" title=\"Permalink to this heading\">#</a></h2>\n<p>Add a Maxwell 3D setup with frequency points at DC, 50 Hz, and 200Hz.\nOtherwise, the default PyAEDT setup values are used. To approximate a DC field in the\nEddy Current solver, use a low frequency value. Second-order shape functions improve\nthe smoothness of the induced currents in the plate.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dc_freq</span> <span class=\"o\">=</span> <span class=\"mf\">0.1</span>\n<span class=\"n\">stop_freq</span> <span class=\"o\">=</span> <span class=\"mi\">50</span>\n\n<span class=\"n\">Setup</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">create_setup</span><span class=\"p\">(</span><span class=\"n\">setupname</span><span class=\"o\">=</span><span class=\"s2\">&quot;Setup1&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Setup</span><span class=\"o\">.</span><span class=\"n\">props</span><span class=\"p\">[</span><span class=\"s2\">&quot;Frequency&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;200Hz&quot;</span>\n<span class=\"n\">Setup</span><span class=\"o\">.</span><span class=\"n\">props</span><span class=\"p\">[</span><span class=\"s2\">&quot;HasSweepSetup&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n<span class=\"n\">Setup</span><span class=\"o\">.</span><span class=\"n\">add_eddy_current_sweep</span><span class=\"p\">(</span><span class=\"s2\">&quot;LinearStep&quot;</span><span class=\"p\">,</span> <span class=\"n\">dc_freq</span><span class=\"p\">,</span> <span class=\"n\">stop_freq</span><span class=\"p\">,</span> <span class=\"n\">stop_freq</span> <span class=\"o\">-</span> <span class=\"n\">dc_freq</span><span class=\"p\">,</span> <span class=\"n\">clear</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n<span class=\"n\">Setup</span><span class=\"o\">.</span><span class=\"n\">props</span><span class=\"p\">[</span><span class=\"s2\">&quot;UseHighOrderShapeFunc&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n<span class=\"n\">Setup</span><span class=\"o\">.</span><span class=\"n\">props</span><span class=\"p\">[</span><span class=\"s2\">&quot;PercentError&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mf\">0.4</span>\n</pre></div>\n</div>\n</section>\n<section id=\"define-coil-dimensions\">\n<h2>Define coil dimensions<a class=\"headerlink\" href=\"#define-coil-dimensions\" title=\"Permalink to this heading\">#</a></h2>\n<p>Define coil dimensions as shown on the TEAM7 drawing of the coil.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">coil_external</span> <span class=\"o\">=</span> <span class=\"mi\">150</span> <span class=\"o\">+</span> <span class=\"mi\">25</span> <span class=\"o\">+</span> <span class=\"mi\">25</span>\n<span class=\"n\">coil_internal</span> <span class=\"o\">=</span> <span class=\"mi\">150</span>\n<span class=\"n\">coil_r1</span> <span class=\"o\">=</span> <span class=\"mi\">25</span>\n<span class=\"n\">coil_r2</span> <span class=\"o\">=</span> <span class=\"mi\">50</span>\n<span class=\"n\">coil_thk</span> <span class=\"o\">=</span> <span class=\"n\">coil_r2</span> <span class=\"o\">-</span> <span class=\"n\">coil_r1</span>\n<span class=\"n\">coil_height</span> <span class=\"o\">=</span> <span class=\"mi\">100</span>\n<span class=\"n\">coil_centre</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mi\">294</span> <span class=\"o\">-</span> <span class=\"mi\">25</span> <span class=\"o\">-</span> <span class=\"mi\">150</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">25</span> <span class=\"o\">+</span> <span class=\"mi\">150</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">19</span> <span class=\"o\">+</span> <span class=\"mi\">30</span> <span class=\"o\">+</span> <span class=\"mi\">100</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">]</span>\n\n<span class=\"c1\"># Use expressions to construct the three dimensions needed to describe the midpoints of</span>\n<span class=\"c1\"># the coil.</span>\n\n<span class=\"n\">dim1</span> <span class=\"o\">=</span> <span class=\"n\">coil_internal</span> <span class=\"o\">/</span> <span class=\"mi\">2</span> <span class=\"o\">+</span> <span class=\"p\">(</span><span class=\"n\">coil_external</span> <span class=\"o\">-</span> <span class=\"n\">coil_internal</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"mi\">4</span>\n<span class=\"n\">dim2</span> <span class=\"o\">=</span> <span class=\"n\">coil_internal</span> <span class=\"o\">/</span> <span class=\"mi\">2</span> <span class=\"o\">-</span> <span class=\"n\">coil_r1</span>\n<span class=\"n\">dim3</span> <span class=\"o\">=</span> <span class=\"n\">dim2</span> <span class=\"o\">+</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sqrt</span><span class=\"p\">(((</span><span class=\"n\">coil_r1</span> <span class=\"o\">+</span> <span class=\"p\">(</span><span class=\"n\">coil_r2</span> <span class=\"o\">-</span> <span class=\"n\">coil_r1</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"o\">**</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Use coordinates to draw a polyline along which to sweep the coil cross sections.</span>\n<span class=\"n\">P1</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">dim1</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"n\">dim2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">P2</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">dim1</span><span class=\"p\">,</span> <span class=\"n\">dim2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">P3</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">dim3</span><span class=\"p\">,</span> <span class=\"n\">dim3</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">P4</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">dim2</span><span class=\"p\">,</span> <span class=\"n\">dim1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n</section>\n<section id=\"create-coordinate-system-for-positioning-coil\">\n<h2>Create coordinate system for positioning coil<a class=\"headerlink\" href=\"#create-coordinate-system-for-positioning-coil\" title=\"Permalink to this heading\">#</a></h2>\n<p>Create a coordinate system for positioning the coil.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_coordinate_system</span><span class=\"p\">(</span><span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"n\">coil_centre</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"s2\">&quot;view&quot;</span><span class=\"p\">,</span> <span class=\"n\">view</span><span class=\"o\">=</span><span class=\"s2\">&quot;XY&quot;</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;Coil_CS&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>&lt;pyaedt.modeler.cad.Modeler.CoordinateSystem object at 0x000002573A48E610&gt;\n</pre></div>\n</div>\n</section>\n<section id=\"create-polyline\">\n<h2>Create polyline<a class=\"headerlink\" href=\"#create-polyline\" title=\"Permalink to this heading\">#</a></h2>\n<p>Create a polyline. One quarter of the coil is modeled by sweeping a 2D sheet along a polyline.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">test</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_polyline</span><span class=\"p\">(</span><span class=\"n\">position_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"n\">P1</span><span class=\"p\">,</span> <span class=\"n\">P2</span><span class=\"p\">,</span> <span class=\"n\">P3</span><span class=\"p\">,</span> <span class=\"n\">P4</span><span class=\"p\">],</span> <span class=\"n\">segment_type</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;Line&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Arc&quot;</span><span class=\"p\">],</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;Coil&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">test</span><span class=\"o\">.</span><span class=\"n\">set_crosssection_properties</span><span class=\"p\">(</span><span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"s2\">&quot;Rectangle&quot;</span><span class=\"p\">,</span> <span class=\"n\">width</span><span class=\"o\">=</span><span class=\"n\">coil_thk</span><span class=\"p\">,</span> <span class=\"n\">height</span><span class=\"o\">=</span><span class=\"n\">coil_height</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"duplicate-and-unite-polyline-to-create-full-coil\">\n<h2>Duplicate and unite polyline to create full coil<a class=\"headerlink\" href=\"#duplicate-and-unite-polyline-to-create-full-coil\" title=\"Permalink to this heading\">#</a></h2>\n<p>Duplicate and unit the polyline to create a full coil.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">duplicate_around_axis</span><span class=\"p\">(</span>\n    <span class=\"s2\">&quot;Coil&quot;</span><span class=\"p\">,</span> <span class=\"n\">cs_axis</span><span class=\"o\">=</span><span class=\"s2\">&quot;Global&quot;</span><span class=\"p\">,</span> <span class=\"n\">angle</span><span class=\"o\">=</span><span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"n\">nclones</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">create_new_objects</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"n\">is_3d_comp</span><span class=\"o\">=</span><span class=\"kc\">False</span>\n<span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">unite</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil,Coil_1,Coil_2&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">unite</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil,Coil_3&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">fit_all</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n</section>\n<section id=\"assign-material-and-if-solution-is-allowed-inside-coil\">\n<h2>Assign material and if solution is allowed inside coil<a class=\"headerlink\" href=\"#assign-material-and-if-solution-is-allowed-inside-coil\" title=\"Permalink to this heading\">#</a></h2>\n<p>Assign the material <code class=\"docutils literal notranslate\"><span class=\"pre\">Cooper</span></code> from the Maxwell internal library to the coil and\nallow a solution inside the coil.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">assign_material</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Copper&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">solve_inside</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"create-terminal\">\n<h2>Create terminal<a class=\"headerlink\" href=\"#create-terminal\" title=\"Permalink to this heading\">#</a></h2>\n<p>Create a terminal for the coil from a cross section that is split and one half deleted.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">section</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;YZ&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">separate_bodies</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil_Section1&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">delete</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil_Section1_Separate1&quot;</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Add variable for coil excitation</span>\n<span class=\"c1\"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"c1\"># Add a design variable for coil excitation. The NB units here are AmpereTurns.</span>\n\n<span class=\"n\">Coil_Excitation</span> <span class=\"o\">=</span> <span class=\"mi\">2742</span>\n<span class=\"n\">M3D</span><span class=\"p\">[</span><span class=\"s2\">&quot;Coil_Excitation&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">Coil_Excitation</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;A&quot;</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">assign_current</span><span class=\"p\">(</span><span class=\"s2\">&quot;Coil_Section1&quot;</span><span class=\"p\">,</span> <span class=\"n\">amplitude</span><span class=\"o\">=</span><span class=\"s2\">&quot;Coil_Excitation&quot;</span><span class=\"p\">,</span> <span class=\"n\">solid</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">set_working_coordinate_system</span><span class=\"p\">(</span><span class=\"s2\">&quot;Global&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"add-a-material\">\n<h2>Add a material<a class=\"headerlink\" href=\"#add-a-material\" title=\"Permalink to this heading\">#</a></h2>\n<p>Add a material named <code class=\"docutils literal notranslate\"><span class=\"pre\">team3_aluminium</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">mat</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">materials</span><span class=\"o\">.</span><span class=\"n\">add_material</span><span class=\"p\">(</span><span class=\"s2\">&quot;team7_aluminium&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">mat</span><span class=\"o\">.</span><span class=\"n\">conductivity</span> <span class=\"o\">=</span> <span class=\"mf\">3.526e7</span>\n</pre></div>\n</div>\n</section>\n<section id=\"model-aluminium-plate-with-a-hole\">\n<h2>Model aluminium plate with a hole<a class=\"headerlink\" href=\"#model-aluminium-plate-with-a-hole\" title=\"Permalink to this heading\">#</a></h2>\n<p>Model the aluminium plate with a hole by subtracting two rectangular cuboids.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">plate</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_box</span><span class=\"p\">(</span><span class=\"n\">position</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">dimensions_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mi\">294</span><span class=\"p\">,</span> <span class=\"mi\">294</span><span class=\"p\">,</span> <span class=\"mi\">19</span><span class=\"p\">],</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;Plate&quot;</span><span class=\"p\">,</span>\n                               <span class=\"n\">matname</span><span class=\"o\">=</span><span class=\"s2\">&quot;team7_aluminium&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">fit_all</span><span class=\"p\">()</span>\n<span class=\"n\">hole</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_box</span><span class=\"p\">(</span><span class=\"n\">position</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mi\">18</span><span class=\"p\">,</span> <span class=\"mi\">18</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">dimensions_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mi\">108</span><span class=\"p\">,</span> <span class=\"mi\">108</span><span class=\"p\">,</span> <span class=\"mi\">19</span><span class=\"p\">],</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s2\">&quot;Hole&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">subtract</span><span class=\"p\">(</span><span class=\"s2\">&quot;Plate&quot;</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"s2\">&quot;Hole&quot;</span><span class=\"p\">],</span> <span class=\"n\">keep_originals</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"draw-a-background-region\">\n<h2>Draw a background region<a class=\"headerlink\" href=\"#draw-a-background-region\" title=\"Permalink to this heading\">#</a></h2>\n<p>Draw a background region that uses the default properties for an air region.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_air_region</span><span class=\"p\">(</span><span class=\"n\">x_pos</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">y_pos</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">z_pos</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">x_neg</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">y_neg</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">z_neg</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>&lt;pyaedt.modeler.cad.object3d.Object3d object at 0x000002573A489820&gt;\n</pre></div>\n</div>\n</section>\n<section id=\"adjust-eddy-effects-for-plate-and-coil\">\n<h2>Adjust eddy effects for plate and coil<a class=\"headerlink\" href=\"#adjust-eddy-effects-for-plate-and-coil\" title=\"Permalink to this heading\">#</a></h2>\n<p>Adjust the eddy effects for the plate and coil by turning off displacement currents\nfor all parts. The setting for eddy effect is ignored for the stranded conductor type\nused in the coil.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">eddy_effects_on</span><span class=\"p\">(</span><span class=\"n\">object_list</span><span class=\"o\">=</span><span class=\"s2\">&quot;Plate&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">eddy_effects_on</span><span class=\"p\">(</span><span class=\"n\">object_list</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s2\">&quot;Coil&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Region&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Line_A1_B1mesh&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Line_A2_B2mesh&quot;</span><span class=\"p\">],</span>\n                    <span class=\"n\">activate_eddy_effects</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                    <span class=\"n\">activate_displacement_current</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"create-expression-for-z-component-of-b-in-gauss\">\n<h2>Create expression for Z component of B in Gauss<a class=\"headerlink\" href=\"#create-expression-for-z-component-of-b-in-gauss\" title=\"Permalink to this heading\">#</a></h2>\n<p>Create an expression for the Z component of B in Gauss using the fields calculator.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Fields</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">odesign</span><span class=\"o\">.</span><span class=\"n\">GetModule</span><span class=\"p\">(</span><span class=\"s2\">&quot;FieldsReporter&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">EnterQty</span><span class=\"p\">(</span><span class=\"s2\">&quot;B&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">CalcOp</span><span class=\"p\">(</span><span class=\"s2\">&quot;ScalarZ&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">EnterScalarFunc</span><span class=\"p\">(</span><span class=\"s2\">&quot;Phase&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">CalcOp</span><span class=\"p\">(</span><span class=\"s2\">&quot;AtPhase&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">EnterScalar</span><span class=\"p\">(</span><span class=\"mi\">10000</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">CalcOp</span><span class=\"p\">(</span><span class=\"s2\">&quot;*&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">CalcOp</span><span class=\"p\">(</span><span class=\"s2\">&quot;Smooth&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">Fields</span><span class=\"o\">.</span><span class=\"n\">AddNamedExpression</span><span class=\"p\">(</span><span class=\"s2\">&quot;Bz&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Fields&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</section>\n<section id=\"draw-two-lines-along-which-to-plot-bz\">\n<h2>Draw two lines along which to plot Bz<a class=\"headerlink\" href=\"#draw-two-lines-along-which-to-plot-bz\" title=\"Permalink to this heading\">#</a></h2>\n<p>Draw two lines along which to plot Bz. The following code also adds a small cylinder\nto refine the mesh locally around each line.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">lines</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;Line_A1_B1&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Line_A2_B2&quot;</span><span class=\"p\">]</span>\n<span class=\"n\">mesh_diameter</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;2mm&quot;</span>\n\n<span class=\"n\">line_points_1</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"s2\">&quot;0mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;72mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;34mm&quot;</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s2\">&quot;288mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;72mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;34mm&quot;</span><span class=\"p\">]]</span>\n<span class=\"n\">polyline</span> <span class=\"o\">=</span> <span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_polyline</span><span class=\"p\">(</span><span class=\"n\">position_list</span><span class=\"o\">=</span><span class=\"n\">line_points_1</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"n\">L1Mesh</span> <span class=\"o\">=</span> <span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_polyline</span><span class=\"p\">(</span><span class=\"n\">position_list</span><span class=\"o\">=</span><span class=\"n\">line_points_1</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;mesh&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">L1Mesh</span><span class=\"o\">.</span><span class=\"n\">set_crosssection_properties</span><span class=\"p\">(</span><span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"s2\">&quot;Circle&quot;</span><span class=\"p\">,</span> <span class=\"n\">width</span><span class=\"o\">=</span><span class=\"n\">mesh_diameter</span><span class=\"p\">)</span>\n\n<span class=\"n\">line_points_2</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"s2\">&quot;0mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;144mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;34mm&quot;</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s2\">&quot;288mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;144mm&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;34mm&quot;</span><span class=\"p\">]]</span>\n<span class=\"n\">polyline2</span> <span class=\"o\">=</span> <span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_polyline</span><span class=\"p\">(</span><span class=\"n\">position_list</span><span class=\"o\">=</span><span class=\"n\">line_points_2</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n<span class=\"n\">polyline2_mesh</span> <span class=\"o\">=</span> <span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">create_polyline</span><span class=\"p\">(</span><span class=\"n\">position_list</span><span class=\"o\">=</span><span class=\"n\">line_points_2</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">lines</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;mesh&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">polyline2_mesh</span><span class=\"o\">.</span><span class=\"n\">set_crosssection_properties</span><span class=\"p\">(</span><span class=\"nb\">type</span><span class=\"o\">=</span><span class=\"s2\">&quot;Circle&quot;</span><span class=\"p\">,</span> <span class=\"n\">width</span><span class=\"o\">=</span><span class=\"n\">mesh_diameter</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"plot-model\">\n<h2>Plot model<a class=\"headerlink\" href=\"#plot-model\" title=\"Permalink to this heading\">#</a></h2>\n<p>Plot the model.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">show</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">export_path</span><span class=\"o\">=</span><span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">working_directory</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Image.jpg&quot;</span><span class=\"p\">),</span> <span class=\"n\">plot_air_objects</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_Maxwell3DTeam7_001.png\" srcset=\"../../_images/sphx_glr_Maxwell3DTeam7_001.png\" alt=\"Maxwell3DTeam7\" class = \"sphx-glr-single-img\"/><div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>&lt;pyaedt.generic.plot.ModelPlotter object at 0x00000257397B4310&gt;\n</pre></div>\n</div>\n<p>Published measurement results are included with this script via the list below.\nTest results are used to create text files for import into a rectangular plot\nand to overlay simulation results.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">project_dir</span> <span class=\"o\">=</span> <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">working_directory</span>\n<span class=\"n\">dataset</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"s2\">&quot;Bz A1_B1 000 0&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A1_B1 050 0&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A1_B1 050 90&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A1_B1 200 0&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A1_B1 200 90&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A2_B2 050 0&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A2_B2 050 90&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A2_B2 200 0&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;Bz A2_B2 200 90&quot;</span><span class=\"p\">,</span>\n<span class=\"p\">]</span>\n<span class=\"n\">header</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s2\">&quot;Distance [mm]&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Bz [Tesla]&quot;</span><span class=\"p\">]</span>\n\n<span class=\"n\">line_length</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">18</span><span class=\"p\">,</span> <span class=\"mi\">36</span><span class=\"p\">,</span> <span class=\"mi\">54</span><span class=\"p\">,</span> <span class=\"mi\">72</span><span class=\"p\">,</span> <span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"mi\">108</span><span class=\"p\">,</span> <span class=\"mi\">126</span><span class=\"p\">,</span> <span class=\"mi\">144</span><span class=\"p\">,</span> <span class=\"mi\">162</span><span class=\"p\">,</span> <span class=\"mi\">180</span><span class=\"p\">,</span> <span class=\"mi\">198</span><span class=\"p\">,</span> <span class=\"mi\">216</span><span class=\"p\">,</span> <span class=\"mi\">234</span><span class=\"p\">,</span> <span class=\"mi\">252</span><span class=\"p\">,</span> <span class=\"mi\">270</span><span class=\"p\">,</span> <span class=\"mi\">288</span><span class=\"p\">]</span>\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n    <span class=\"p\">[</span>\n        <span class=\"o\">-</span><span class=\"mf\">6.667</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">7.764</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">8.707</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">8.812</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">5.870</span><span class=\"p\">,</span>\n        <span class=\"mf\">8.713</span><span class=\"p\">,</span>\n        <span class=\"mf\">50.40</span><span class=\"p\">,</span>\n        <span class=\"mf\">88.47</span><span class=\"p\">,</span>\n        <span class=\"mf\">100.9</span><span class=\"p\">,</span>\n        <span class=\"mf\">104.0</span><span class=\"p\">,</span>\n        <span class=\"mf\">104.8</span><span class=\"p\">,</span>\n        <span class=\"mf\">104.9</span><span class=\"p\">,</span>\n        <span class=\"mf\">104.6</span><span class=\"p\">,</span>\n        <span class=\"mf\">103.1</span><span class=\"p\">,</span>\n        <span class=\"mf\">97.32</span><span class=\"p\">,</span>\n        <span class=\"mf\">75.19</span><span class=\"p\">,</span>\n        <span class=\"mf\">29.04</span><span class=\"p\">,</span>\n    <span class=\"p\">],</span>\n    <span class=\"p\">[</span>\n        <span class=\"mf\">4.90</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">17.88</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">22.13</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">20.19</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">15.67</span><span class=\"p\">,</span>\n        <span class=\"mf\">0.36</span><span class=\"p\">,</span>\n        <span class=\"mf\">43.64</span><span class=\"p\">,</span>\n        <span class=\"mf\">78.11</span><span class=\"p\">,</span>\n        <span class=\"mf\">71.55</span><span class=\"p\">,</span>\n        <span class=\"mf\">60.44</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.91</span><span class=\"p\">,</span>\n        <span class=\"mf\">52.62</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.81</span><span class=\"p\">,</span>\n        <span class=\"mf\">56.91</span><span class=\"p\">,</span>\n        <span class=\"mf\">59.24</span><span class=\"p\">,</span>\n        <span class=\"mf\">52.78</span><span class=\"p\">,</span>\n        <span class=\"mf\">27.61</span><span class=\"p\">,</span>\n    <span class=\"p\">],</span>\n    <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">1.16</span><span class=\"p\">,</span> <span class=\"mf\">2.84</span><span class=\"p\">,</span> <span class=\"mf\">4.15</span><span class=\"p\">,</span> <span class=\"mf\">4.00</span><span class=\"p\">,</span> <span class=\"mf\">3.07</span><span class=\"p\">,</span> <span class=\"mf\">2.31</span><span class=\"p\">,</span> <span class=\"mf\">1.89</span><span class=\"p\">,</span> <span class=\"mf\">4.97</span><span class=\"p\">,</span> <span class=\"mf\">12.61</span><span class=\"p\">,</span> <span class=\"mf\">14.15</span><span class=\"p\">,</span> <span class=\"mf\">13.04</span><span class=\"p\">,</span> <span class=\"mf\">12.40</span><span class=\"p\">,</span> <span class=\"mf\">12.05</span><span class=\"p\">,</span> <span class=\"mf\">12.27</span><span class=\"p\">,</span> <span class=\"mf\">12.66</span><span class=\"p\">,</span> <span class=\"mf\">9.96</span><span class=\"p\">,</span> <span class=\"mf\">2.36</span><span class=\"p\">],</span>\n    <span class=\"p\">[</span>\n        <span class=\"o\">-</span><span class=\"mf\">3.63</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">18.46</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">23.62</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">21.59</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">16.09</span><span class=\"p\">,</span>\n        <span class=\"mf\">0.23</span><span class=\"p\">,</span>\n        <span class=\"mf\">44.35</span><span class=\"p\">,</span>\n        <span class=\"mf\">75.53</span><span class=\"p\">,</span>\n        <span class=\"mf\">63.42</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.20</span><span class=\"p\">,</span>\n        <span class=\"mf\">48.66</span><span class=\"p\">,</span>\n        <span class=\"mf\">47.31</span><span class=\"p\">,</span>\n        <span class=\"mf\">48.31</span><span class=\"p\">,</span>\n        <span class=\"mf\">51.26</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.61</span><span class=\"p\">,</span>\n        <span class=\"mf\">46.11</span><span class=\"p\">,</span>\n        <span class=\"mf\">24.96</span><span class=\"p\">,</span>\n    <span class=\"p\">],</span>\n    <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">1.38</span><span class=\"p\">,</span> <span class=\"mf\">1.20</span><span class=\"p\">,</span> <span class=\"mf\">2.15</span><span class=\"p\">,</span> <span class=\"mf\">1.63</span><span class=\"p\">,</span> <span class=\"mf\">1.10</span><span class=\"p\">,</span> <span class=\"mf\">0.27</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">2.28</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">1.40</span><span class=\"p\">,</span> <span class=\"mf\">4.17</span><span class=\"p\">,</span> <span class=\"mf\">3.94</span><span class=\"p\">,</span> <span class=\"mf\">4.86</span><span class=\"p\">,</span> <span class=\"mf\">4.09</span><span class=\"p\">,</span> <span class=\"mf\">3.69</span><span class=\"p\">,</span> <span class=\"mf\">4.60</span><span class=\"p\">,</span> <span class=\"mf\">3.48</span><span class=\"p\">,</span> <span class=\"mf\">4.10</span><span class=\"p\">,</span> <span class=\"mf\">0.98</span><span class=\"p\">],</span>\n    <span class=\"p\">[</span>\n        <span class=\"o\">-</span><span class=\"mf\">1.83</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">8.50</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">13.60</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">15.21</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">14.48</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">5.62</span><span class=\"p\">,</span>\n        <span class=\"mf\">28.77</span><span class=\"p\">,</span>\n        <span class=\"mf\">60.34</span><span class=\"p\">,</span>\n        <span class=\"mf\">61.84</span><span class=\"p\">,</span>\n        <span class=\"mf\">56.64</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.40</span><span class=\"p\">,</span>\n        <span class=\"mf\">52.36</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.93</span><span class=\"p\">,</span>\n        <span class=\"mf\">56.82</span><span class=\"p\">,</span>\n        <span class=\"mf\">59.48</span><span class=\"p\">,</span>\n        <span class=\"mf\">52.08</span><span class=\"p\">,</span>\n        <span class=\"mf\">26.56</span><span class=\"p\">,</span>\n    <span class=\"p\">],</span>\n    <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">1.63</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.60</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.43</span><span class=\"p\">,</span> <span class=\"mf\">0.11</span><span class=\"p\">,</span> <span class=\"mf\">1.26</span><span class=\"p\">,</span> <span class=\"mf\">3.40</span><span class=\"p\">,</span> <span class=\"mf\">6.53</span><span class=\"p\">,</span> <span class=\"mf\">10.25</span><span class=\"p\">,</span> <span class=\"mf\">11.83</span><span class=\"p\">,</span> <span class=\"mf\">11.83</span><span class=\"p\">,</span> <span class=\"mf\">11.01</span><span class=\"p\">,</span> <span class=\"mf\">10.58</span><span class=\"p\">,</span> <span class=\"mf\">10.80</span><span class=\"p\">,</span> <span class=\"mf\">10.54</span><span class=\"p\">,</span> <span class=\"mf\">10.62</span><span class=\"p\">,</span> <span class=\"mf\">9.03</span><span class=\"p\">,</span> <span class=\"mf\">1.79</span><span class=\"p\">],</span>\n    <span class=\"p\">[</span>\n        <span class=\"o\">-</span><span class=\"mf\">0.86</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">7.00</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">11.58</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">13.36</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">13.77</span><span class=\"p\">,</span>\n        <span class=\"o\">-</span><span class=\"mf\">6.74</span><span class=\"p\">,</span>\n        <span class=\"mf\">24.63</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.19</span><span class=\"p\">,</span>\n        <span class=\"mf\">54.89</span><span class=\"p\">,</span>\n        <span class=\"mf\">50.72</span><span class=\"p\">,</span>\n        <span class=\"mf\">48.03</span><span class=\"p\">,</span>\n        <span class=\"mf\">47.13</span><span class=\"p\">,</span>\n        <span class=\"mf\">48.25</span><span class=\"p\">,</span>\n        <span class=\"mf\">51.35</span><span class=\"p\">,</span>\n        <span class=\"mf\">53.35</span><span class=\"p\">,</span>\n        <span class=\"mf\">45.37</span><span class=\"p\">,</span>\n        <span class=\"mf\">24.01</span><span class=\"p\">,</span>\n    <span class=\"p\">],</span>\n    <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">1.35</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.71</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.81</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">0.67</span><span class=\"p\">,</span> <span class=\"mf\">0.15</span><span class=\"p\">,</span> <span class=\"mf\">1.39</span><span class=\"p\">,</span> <span class=\"mf\">2.67</span><span class=\"p\">,</span> <span class=\"mf\">3.00</span><span class=\"p\">,</span> <span class=\"mf\">4.01</span><span class=\"p\">,</span> <span class=\"mf\">3.80</span><span class=\"p\">,</span> <span class=\"mf\">4.00</span><span class=\"p\">,</span> <span class=\"mf\">3.02</span><span class=\"p\">,</span> <span class=\"mf\">2.20</span><span class=\"p\">,</span> <span class=\"mf\">2.78</span><span class=\"p\">,</span> <span class=\"mf\">1.58</span><span class=\"p\">,</span> <span class=\"mf\">1.37</span><span class=\"p\">,</span> <span class=\"mf\">0.93</span><span class=\"p\">],</span>\n<span class=\"p\">]</span>\n\n<span class=\"c1\"># Dataset details are used to encode test parameters in the text files.</span>\n<span class=\"c1\"># For example, ``Bz A1_B1 050 0`` is the Z component of flux density ``B``</span>\n<span class=\"c1\"># along line ``A1_B1`` at 50 Hz and 0 deg. These text files are created</span>\n<span class=\"c1\"># and saved in the default project directory.</span>\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;project_dir&quot;</span><span class=\"p\">,</span> <span class=\"n\">project_dir</span><span class=\"p\">)</span>\n<span class=\"n\">dataset_range</span> <span class=\"o\">=</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">dataset</span><span class=\"p\">),</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"n\">line_length_range</span> <span class=\"o\">=</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">line_length</span><span class=\"p\">),</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"n\">dataset_list</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n\n<span class=\"k\">for</span> <span class=\"n\">item</span> <span class=\"ow\">in</span> <span class=\"n\">dataset_range</span><span class=\"p\">:</span>\n    <span class=\"n\">dataset_list</span><span class=\"o\">.</span><span class=\"n\">clear</span><span class=\"p\">()</span>\n    <span class=\"k\">for</span> <span class=\"n\">jtem</span> <span class=\"ow\">in</span> <span class=\"n\">line_length_range</span><span class=\"p\">:</span>\n        <span class=\"n\">dataset_list</span><span class=\"o\">.</span><span class=\"n\">insert</span><span class=\"p\">(</span><span class=\"n\">jtem</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"n\">jtem</span><span class=\"p\">])</span>\n        <span class=\"n\">ziplist</span> <span class=\"o\">=</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">line_length</span><span class=\"p\">,</span> <span class=\"n\">dataset_list</span><span class=\"p\">)</span>\n    <span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"n\">project_dir</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;</span><span class=\"se\">\\\\</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">])</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;.csv&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;w&quot;</span><span class=\"p\">,</span> <span class=\"n\">newline</span><span class=\"o\">=</span><span class=\"s2\">&quot;&quot;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n        <span class=\"n\">writer</span> <span class=\"o\">=</span> <span class=\"n\">csv</span><span class=\"o\">.</span><span class=\"n\">writer</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">,</span> <span class=\"n\">delimiter</span><span class=\"o\">=</span><span class=\"s2\">&quot;,&quot;</span><span class=\"p\">)</span>\n        <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">writerow</span><span class=\"p\">(</span><span class=\"n\">header</span><span class=\"p\">)</span>\n        <span class=\"n\">writer</span><span class=\"o\">.</span><span class=\"n\">writerows</span><span class=\"p\">(</span><span class=\"n\">ziplist</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Create rectangular plots</span>\n<span class=\"c1\"># ~~~~~~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"c1\"># Create rectangular plots, using text file encoding to control their formatting. Create</span>\n<span class=\"c1\"># the DC plot separately because it needs a different frequency and phase than the other plots.</span>\n\n<span class=\"k\">for</span> <span class=\"n\">item</span> <span class=\"ow\">in</span> <span class=\"n\">dataset_range</span><span class=\"p\">:</span>\n    <span class=\"k\">if</span> <span class=\"n\">item</span> <span class=\"o\">%</span> <span class=\"mi\">2</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n        <span class=\"n\">plotname</span> <span class=\"o\">=</span> <span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">3</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;Along the Line&quot;</span> <span class=\"o\">+</span> <span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">2</span><span class=\"p\">:</span><span class=\"mi\">9</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;, &quot;</span> <span class=\"o\">+</span> <span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">12</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;Hz&quot;</span>\n        <span class=\"k\">if</span> <span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">12</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;000&quot;</span><span class=\"p\">:</span>\n            <span class=\"n\">variations</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n                <span class=\"s2\">&quot;Distance&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;All&quot;</span><span class=\"p\">],</span>\n                <span class=\"s2\">&quot;Freq&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">dc_freq</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;Hz&quot;</span><span class=\"p\">],</span>\n                <span class=\"s2\">&quot;Phase&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;0deg&quot;</span><span class=\"p\">],</span>\n                <span class=\"s2\">&quot;Coil_Excitation&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;All&quot;</span><span class=\"p\">],</span>\n            <span class=\"p\">}</span>\n            <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">create_report</span><span class=\"p\">(</span>\n                <span class=\"n\">plotname</span><span class=\"o\">=</span><span class=\"n\">plotname</span><span class=\"p\">,</span>\n                <span class=\"n\">report_category</span><span class=\"o\">=</span><span class=\"s2\">&quot;Fields&quot;</span><span class=\"p\">,</span>\n                <span class=\"n\">context</span><span class=\"o\">=</span><span class=\"s2\">&quot;Line_&quot;</span> <span class=\"o\">+</span> <span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"mi\">8</span><span class=\"p\">],</span>\n                <span class=\"n\">primary_sweep_variable</span><span class=\"o\">=</span><span class=\"s2\">&quot;Distance&quot;</span><span class=\"p\">,</span>\n                <span class=\"n\">variations</span><span class=\"o\">=</span><span class=\"n\">variations</span><span class=\"p\">,</span>\n                <span class=\"n\">expressions</span><span class=\"o\">=</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"p\">],</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">variations</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n                <span class=\"s2\">&quot;Distance&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;All&quot;</span><span class=\"p\">],</span>\n                <span class=\"s2\">&quot;Freq&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">12</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;Hz&quot;</span><span class=\"p\">],</span>\n                <span class=\"s2\">&quot;Phase&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;0deg&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;90deg&quot;</span><span class=\"p\">],</span>\n                <span class=\"s2\">&quot;Coil_Excitation&quot;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s2\">&quot;All&quot;</span><span class=\"p\">],</span>\n            <span class=\"p\">}</span>\n            <span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">create_report</span><span class=\"p\">(</span>\n                <span class=\"n\">plotname</span><span class=\"o\">=</span><span class=\"n\">plotname</span><span class=\"p\">,</span>\n                <span class=\"n\">report_category</span><span class=\"o\">=</span><span class=\"s2\">&quot;Fields&quot;</span><span class=\"p\">,</span>\n                <span class=\"n\">context</span><span class=\"o\">=</span><span class=\"s2\">&quot;Line_&quot;</span> <span class=\"o\">+</span> <span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">3</span><span class=\"p\">:</span><span class=\"mi\">8</span><span class=\"p\">],</span>\n                <span class=\"n\">primary_sweep_variable</span><span class=\"o\">=</span><span class=\"s2\">&quot;Distance&quot;</span><span class=\"p\">,</span>\n                <span class=\"n\">variations</span><span class=\"o\">=</span><span class=\"n\">variations</span><span class=\"p\">,</span>\n                <span class=\"n\">expressions</span><span class=\"o\">=</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">][</span><span class=\"mi\">0</span><span class=\"p\">:</span><span class=\"mi\">2</span><span class=\"p\">],</span>\n            <span class=\"p\">)</span>\n\n<span class=\"c1\"># Import test data into correct plot and overlay with simulation results</span>\n<span class=\"c1\"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>\n<span class=\"c1\"># Import test data into the correct plot and overlay it with the simulation results.</span>\n\n<span class=\"k\">if</span> <span class=\"n\">item</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n    <span class=\"n\">Plot</span><span class=\"o\">.</span><span class=\"n\">ImportIntoReport</span><span class=\"p\">(</span><span class=\"n\">plotname</span><span class=\"p\">,</span> <span class=\"n\">os</span><span class=\"o\">.</span><span class=\"n\">path</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">project_dir</span><span class=\"p\">,</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">])</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;.csv&quot;</span><span class=\"p\">))</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">Plot</span><span class=\"o\">.</span><span class=\"n\">ImportIntoReport</span><span class=\"p\">(</span><span class=\"n\">plotname</span><span class=\"p\">,</span> <span class=\"n\">project_dir</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;</span><span class=\"se\">\\\\</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span> <span class=\"o\">-</span> <span class=\"mi\">1</span><span class=\"p\">])</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;.csv&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">Plot</span><span class=\"o\">.</span><span class=\"n\">ImportIntoReport</span><span class=\"p\">(</span><span class=\"n\">plotname</span><span class=\"p\">,</span> <span class=\"n\">project_dir</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;</span><span class=\"se\">\\\\</span><span class=\"s2\">&quot;</span> <span class=\"o\">+</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"n\">dataset</span><span class=\"p\">[</span><span class=\"n\">item</span><span class=\"p\">])</span> <span class=\"o\">+</span> <span class=\"s2\">&quot;.csv&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>project_dir D:/Temp/pyaedt_prj_UT8/Project_LRW.pyaedt\\TEAM 7 Asymmetric Conductor\n</pre></div>\n</div>\n</section>\n<section id=\"create-plots-of-induced-current-and-flux-density-on-surface-of-plate\">\n<h2>Create plots of induced current and flux density on surface of plate<a class=\"headerlink\" href=\"#create-plots-of-induced-current-and-flux-density-on-surface-of-plate\" title=\"Permalink to this heading\">#</a></h2>\n<p>Create two plots of the induced current (<code class=\"docutils literal notranslate\"><span class=\"pre\">Mag_J</span></code>) and the flux density (<code class=\"docutils literal notranslate\"><span class=\"pre\">Mag_B</span></code>) on the\nsurface of the plate.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">surflist</span> <span class=\"o\">=</span> <span class=\"n\">modeler</span><span class=\"o\">.</span><span class=\"n\">get_object_faces</span><span class=\"p\">(</span><span class=\"s2\">&quot;Plate&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">intrinsic_dict</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s2\">&quot;Freq&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;200Hz&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Phase&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;0deg&quot;</span><span class=\"p\">}</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">create_fieldplot_surface</span><span class=\"p\">(</span><span class=\"n\">surflist</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Mag_J&quot;</span><span class=\"p\">,</span> <span class=\"n\">intrinsincDict</span><span class=\"o\">=</span><span class=\"n\">intrinsic_dict</span><span class=\"p\">,</span> <span class=\"n\">plot_name</span><span class=\"o\">=</span><span class=\"s2\">&quot;Mag_J&quot;</span><span class=\"p\">)</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"o\">.</span><span class=\"n\">create_fieldplot_surface</span><span class=\"p\">(</span><span class=\"n\">surflist</span><span class=\"p\">,</span> <span class=\"s2\">&quot;Mag_B&quot;</span><span class=\"p\">,</span> <span class=\"n\">intrinsincDict</span><span class=\"o\">=</span><span class=\"n\">intrinsic_dict</span><span class=\"p\">,</span> <span class=\"n\">plot_name</span><span class=\"o\">=</span><span class=\"s2\">&quot;Mag_B&quot;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>&lt;pyaedt.modules.solutions.FieldPlot object at 0x000002573B447DC0&gt;\n</pre></div>\n</div>\n</section>\n<section id=\"save-project-and-solve\">\n<h2>Save project and solve<a class=\"headerlink\" href=\"#save-project-and-solve\" title=\"Permalink to this heading\">#</a></h2>\n<p>Save the project and solve it.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">save_project</span><span class=\"p\">()</span>\n<span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">analyze_all</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n</section>\n<section id=\"release-aedt-from-pyaedt-scripting\">\n<h2>Release AEDT from PyAEDT scripting<a class=\"headerlink\" href=\"#release-aedt-from-pyaedt-scripting\" title=\"Permalink to this heading\">#</a></h2>\n<p>Release AEDT from PyAEDT scripting. If you wanted to leave AEDT and the project open\nafter running the above script, in the following command, you would set <code class=\"docutils literal notranslate\"><span class=\"pre\">(False,</span> <span class=\"pre\">False)</span></code>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">M3D</span><span class=\"o\">.</span><span class=\"n\">release_desktop</span><span class=\"p\">(</span><span class=\"kc\">True</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>True\n</pre></div>\n</div>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 4 minutes  39.396 seconds)</p>\n<div class=\"sphx-glr-footer sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-03-maxwell-maxwell3dteam7-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/8b986a64b6ba596a3c13633bd7ddcc1c/Maxwell3DTeam7.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">Maxwell3DTeam7.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/bff82223783d88e82227125fba51f23c/Maxwell3DTeam7.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">Maxwell3DTeam7.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples/03-Maxwell/Maxwell3D_Choke", "Maxwell 3D: choke setup", "N", "next"], ["examples/03-Maxwell/Maxwell3DTeam3", "Maxwell 3D: bath plate analysis", "P", "previous"]], "sourcename": "examples/03-Maxwell/Maxwell3DTeam7.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Maxwell 3D: asymmetric conductor analysis</a><ul>\n<li><a class=\"reference internal\" href=\"#perform-required-imports\">Perform required imports</a></li>\n<li><a class=\"reference internal\" href=\"#set-non-graphical-mode\">Set non-graphical mode</a></li>\n<li><a class=\"reference internal\" href=\"#launch-aedt-and-maxwell-3d\">Launch AEDT and Maxwell 3D</a></li>\n<li><a class=\"reference internal\" href=\"#add-maxwell-3d-setup\">Add Maxwell 3D setup</a></li>\n<li><a class=\"reference internal\" href=\"#define-coil-dimensions\">Define coil dimensions</a></li>\n<li><a class=\"reference internal\" href=\"#create-coordinate-system-for-positioning-coil\">Create coordinate system for positioning coil</a></li>\n<li><a class=\"reference internal\" href=\"#create-polyline\">Create polyline</a></li>\n<li><a class=\"reference internal\" href=\"#duplicate-and-unite-polyline-to-create-full-coil\">Duplicate and unite polyline to create full coil</a></li>\n<li><a class=\"reference internal\" href=\"#assign-material-and-if-solution-is-allowed-inside-coil\">Assign material and if solution is allowed inside coil</a></li>\n<li><a class=\"reference internal\" href=\"#create-terminal\">Create terminal</a></li>\n<li><a class=\"reference internal\" href=\"#add-a-material\">Add a material</a></li>\n<li><a class=\"reference internal\" href=\"#model-aluminium-plate-with-a-hole\">Model aluminium plate with a hole</a></li>\n<li><a class=\"reference internal\" href=\"#draw-a-background-region\">Draw a background region</a></li>\n<li><a class=\"reference internal\" href=\"#adjust-eddy-effects-for-plate-and-coil\">Adjust eddy effects for plate and coil</a></li>\n<li><a class=\"reference internal\" href=\"#create-expression-for-z-component-of-b-in-gauss\">Create expression for Z component of B in Gauss</a></li>\n<li><a class=\"reference internal\" href=\"#draw-two-lines-along-which-to-plot-bz\">Draw two lines along which to plot Bz</a></li>\n<li><a class=\"reference internal\" href=\"#plot-model\">Plot model</a></li>\n<li><a class=\"reference internal\" href=\"#create-plots-of-induced-current-and-flux-density-on-surface-of-plate\">Create plots of induced current and flux density on surface of plate</a></li>\n<li><a class=\"reference internal\" href=\"#save-project-and-solve\">Save project and solve</a></li>\n<li><a class=\"reference internal\" href=\"#release-aedt-from-pyaedt-scripting\">Release AEDT from PyAEDT scripting</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples/03-Maxwell/Maxwell3DTeam7", "sidebars": ["search-field.html", "sidebar-nav-bs.html"], "customsidebar": null, "favicon_url": null, "logo_url": null, "alabaster_version": "0.7.13", "theme_show_toc_level": 1, "theme_logo": {}}